#!/bin/bash
# XMonad startup script with system tray and automatic monitor detection

# Ensure user bin is in PATH for dmenu
export PATH="$HOME/bin:$PATH"

# Load Xresources
[ -f ~/.Xresources ] && xrdb -merge ~/.Xresources

# Set keyboard options
setxkbmap -option ctrl:nocaps

# Detect and configure monitors with autorandr
# This will automatically apply the best matching profile
if command -v autorandr > /dev/null 2>&1; then
    autorandr --change --default laptop
fi

# Start system tray
stalonetray &

# Start network manager applet
nm-applet --indicator &

# Start volume control (pasystray for PulseAudio)
# Set GTK theme for proper icon display
GTK_THEME=Adwaita XDG_CURRENT_DESKTOP=GNOME pasystray &

# Start Bluetooth manager
blueman-applet &

# Optional: Add other tray applications here
# cbatticon &
# redshift-gtk &

# Start XMonad
exec xmonad